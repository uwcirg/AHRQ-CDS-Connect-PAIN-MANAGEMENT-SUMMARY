{
  "PertinentMedicalHistory": {
    "title": "Pertinent Medical History",
    "sections": [
      {
        "name": "Conditions Associated with Chronic Pain",
        "dataKey": "ConditionsAssociatedWithChronicPain",
        "dataKeySource": "PertinentMedicalHistory",
        "info": [
          {
            "type": "elements",
            "description": "Conditions Associated with Chronic Pain queries the following elements:",
            "elements": [
              {
                "name": "Conditions associated with chronic pain",
                "status": "active or recurring",
                "lookback": "n/a"
              }
            ]
          }
        ],
        "tables": [
          {
            "headers": {
              "Name": "Name",
              "Status": "Status",
              "Start": {
                "key": "Onset",
                "formatter": "datishFormat",
                "minWidth": 150
              },
              "End": {
                "key": "Abatement",
                "formatter": "datishFormat",
                "minWidth": 150
              },
              "Recorded": {
                "key": "DateRecorded",
                "formatter": "datishFormat"
              }
            }
          }
        ]
      },
      {
        "name": "Risk Factors for Opioid-related Harms",
        "dataKey": "RiskFactorsForOpioidRelatedHarms",
        "dataKeySource": "PertinentMedicalHistory",
        "info": [
          {
            "type": "elements",
            "description": "Risk Factors for Opioid-related Harms queries the following elements:",
            "elements": [
              {
                "name": "Depression",
                "status": "active or recurring",
                "lookback": "n/a"
              },
              {
                "name": "Anxiety",
                "status": "active or recurring",
                "lookback": "n/a"
              },
              {
                "name": "Substance use disorder",
                "status": "any",
                "lookback": "n/a"
              },
              {
                "name": "Suicide attempt",
                "status": "any",
                "lookback": "n/a"
              },
              {
                "name": "Sleep-disordered breathing",
                "status": "active or recurring",
                "lookback": "n/a"
              },
              {
                "name": "Renal dysfunction",
                "status": "active or recurring",
                "lookback": "n/a"
              },
              {
                "name": "Hepatic dysfunction",
                "status": "active or recurring",
                "lookback": "n/a"
              },
              {
                "name": "Pregnancy",
                "status": "active or recurring",
                "lookback": "42 weeks"
              },
              {
                "name": "Age >= 65 YRS",
                "status": "n/a",
                "lookback": "n/a"
              }
            ]
          }
        ],
        "tables": [
          {
            "headers": {
              "Name": "Name",
              "Status": "Status",
              "Start": {
                "key": "Onset",
                "formatter": "datishFormat",
                "minWidth": 150
              },
              "End": {
                "key": "Abatement",
                "formatter": "datishFormat",
                "minWidth": 150
              },
              "Recorded": {
                "key": "DateRecorded",
                "formatter": "datishFormat"
              }
            },
            "filter": "!Visit",
            "flags": [
              {
                "flag": "always",
                "flagText": "CDC Guideline #8: Mitigate risk; WA AMDG Guideline: Avoid opioids if there is any FDA or clinical contraindications."
              }
            ]
          },
          {
            "headers": {
              "Name": "Name",
              "Visit": {
                "key": "Visit",
                "formatter": "datishAgeFormat",
                "minWidth": 150
              }
            },
            "filter": "Visit",
            "flags": [
              {
                "flag": "always",
                "flagText": "Factor that may place the patient at risk for an opioid-related harm"
              }
            ]
          }
        ]
      }
    ]
  },
  "PainAssessments": {
    "title": "Pain Assessments",
    "sections": [
        {
          "name": "Numeric Pain Intensity Assessments",
          "dataKey": "NumericPainIntensityAssessments",
          "dataKeySource": "PainAssessments",
          "info": [
            {
              "type": "elements",
              "description": "Numeric Pain Intensity Assessments queries the following elements:",
              "elements": [
                {
                  "name": "Numeric pain intensity assessment",
                  "status": "final or amended",
                  "lookback": "2 years"
                }
              ]
            }
          ],
          "tables": [
            {
              "headers": {
                "Name": "Name",
                "Score": { "key": "Score", "formatter": "quantityFormat" },
                "Date": { "key": "Date", "formatter": "datishFormat" }
              }
            }
          ]
        },
        {
          "name": "Pain Enjoyment General Activity (PEG) Assessments",
          "dataKey": "PainEnjoymentGeneralActivityAssessments",
          "dataKeySource": "PainAssessments",
          "info": [
            {
              "type": "elements",
              "description": "Pain Enjoyment General Activity (PEG) Assessments queries the following elements:",
              "elements": [
                {
                  "name": "Pain Enjoyment General Activity (PEG) Assessment",
                  "status": "final or amended",
                  "lookback": "2 years"
                }
              ]
            },
            {
              "type": "reference",
              "url": "https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2686775/",
              "title": "Development and Initial Validation of the PEG, a Three-item Scale Assessing Pain Intensity and Interference",
              "details": "The PEG is freely available in the public domain. Publications and reports should cite the original publication: Krebs EE, Lorenz KA, Bair MJ, Damush TA, Wu J, Sutherland JM, Asch SM, Kroenke K. Development and initial validation of the PEG, a 3-item scale assessing pain intensity and interference. Journal of General Internal Medicine. 2009 Jun;24:733-738."
            }
          ],
          "tables": [
            {
              "headers": {
                "Name": "Name",
                "Score": { "key": "Score", "formatter": "quantityFormat" },
                "Question": {
                  "key": "Questions",
                  "formatter": "arrayFlatten",
                  "formatterArguments": ["Name", "Score", true],
                  "sortable": false,
                  "minWidth": 200
                },
                "Question Score": {
                  "key": "Questions",
                  "formatter": "arrayFlatten",
                  "formatterArguments": ["Score", null, false],
                  "sortable": false,
                  "minWidth": 150
                },
                "Date": { "key": "Date", "formatter": "datishFormat" }
              }
            }
          ]
        },
        {
          "name": "STarT Back Assessments",
          "dataKey": "STarTBackAssessments",
          "dataKeySource": "PainAssessments",
          "info": [
            {
              "type": "elements",
              "description": "STarT Back Assessments queries the following elements:",
              "elements": [
                {
                  "name": "STarT Back Screening Tool",
                  "status": "final or amended",
                  "lookback": "2 years"
                }
              ]
            },
            {
              "type": "reference",
              "url": "https://www.keele.ac.uk/sbst/",
              "title": "STarT Back",
              "details": "Copyright (Â©2007) University of Keele. No license is required for non-commercial use.  If you would like to incorporate the tool in any way into commercial product materials, please contact Keele University for further advice."
            }
          ],
          "tables": [
            {
              "headers": {
                "Name": "Name",
                "Score": { "key": "Score", "formatter": "quantityFormat" },
                "Date": { "key": "Date", "formatter": "datishFormat" }
              }
            }
          ]
        }
      ]
    },
    "HistoricalTreatments": {
     "title": "EHR Medications",
     "sections": [
        {
          "name": "Opioid Medications",
          "dataKey": "OpioidMedications",
          "dataKeySource": "HistoricalTreatments",
          "info": [
            {
              "type": "elements",
              "description": "Opioid Medications queries the following elements:",
              "elements": [
                {
                  "name": "Opioid medication statements and orders",
                  "status": "any",
                  "lookback": "2 years"
                }
              ]
            }
          ],
          "tables": [
            {
              "headers": {
                "Drug Description": "Name",
                "Quantity": { "key": "Quantity", "formatter": "stringSubstitutionFormat", "formatterArguments": [""], "sortable": false},
                "Written Date": { "key": "Start", "formatter": "datishFormat" },
                "Dispensed": { "key": "End", "formatter": "datishFormat" },
                "Prescriber": { "key": "Prescriber", "formatter": "stringSubstitutionFormat", "formatterArguments": [""], "sortable": false},
                "Pharmacy": { "key": "Pharmacy", "formatter": "stringSubstitutionFormat", "formatterArguments": [""], "sortable": false}
              }
            }
          ]
        },
        {
          "name": "Non-Opioid Medications",
          "dataKey": "NonOpioidMedications",
          "dataKeySource": "HistoricalTreatments",
          "info": [
            {
              "type": "elements",
              "description": "Non-Opioid Medications queries the following elements:",
              "elements": [
                {
                  "name": "Non-opioid medication statements and orders",
                  "status": "any",
                  "lookback": "2 years"
                }
              ]
            }
          ],
          "tables": [
            {
              "headers": {
                "Drug Description": "Name",
                "Quantity": { "key": "Quantity", "formatter": "stringSubstitutionFormat", "formatterArguments": [""], "sortable": false},
                "Written Date": { "key": "Start", "formatter": "datishFormat" },
                "Dispensed": { "key": "End", "formatter": "datishFormat" },
                "Prescriber": { "key": "Prescriber", "formatter": "stringSubstitutionFormat", "formatterArguments": [""], "sortable": false},
                "Pharmacy": { "key": "Pharmacy", "formatter": "stringSubstitutionFormat", "formatterArguments": [""], "sortable": false}
              },
              "flags": [
                {
                  "flag": "ifNone",
                  "flagText": "CDC Guideline #1: Opioids are not first-line therapy."
                }
              ]
            }
          ]
        },
        {
          "name": "Stool Softeners and Laxatives",
          "dataKey": "StoolSoftenersAndLaxatives",
          "dataKeySource": "HistoricalTreatments",
          "info": [
            {
              "type": "elements",
              "description": "Stool Softeners and Laxatives queries the following elements:",
              "elements": [
                {
                  "name": "Stool softeners / laxatives medication statements and orders",
                  "status": "any",
                  "lookback": "6 months"
                }
              ]
            }
          ],
          "tables": [
            {
              "headers": {
                "Drug Description": "Name",
                "Quantity": { "key": "Quantity", "formatter": "stringSubstitutionFormat", "formatterArguments": [""], "sortable": false},
                "Written Date": { "key": "Start", "formatter": "datishFormat" },
                "Dispensed": { "key": "End", "formatter": "datishFormat" },
                "Prescriber": { "key": "Prescriber", "formatter": "stringSubstitutionFormat", "formatterArguments": [""], "sortable": false},
                "Pharmacy": { "key": "Pharmacy", "formatter": "stringSubstitutionFormat", "formatterArguments": [""], "sortable": false}
              },
              "flags": [
                {
                  "flag": {
                    "ifAnd": [
                      "ifNone",
                      {
                        "ifOneOrMore": {
                          "table": "OpioidMedications",
                          "source": "HistoricalTreatments"
                        }
                      }
                    ]
                  },
                  "flagText": "CDC Guideline #3: To prevent constipation associated with opioid use, advise patients to increase hydration and fiber intake and to maintain or increase physical activity. Stool softeners or laxatives might be needed."
                }
              ]
            }
          ]
        }
      ]
  },
  "RiskConsiderations": {
    "title": "Risk Considerations",
    "sections":[
      {
        "name": "Most Recent MME",
        "dataKey": "MostRecentMME",
        "dataKeySource": "RiskConsiderations",
        "info": [
          {
            "type": "elements",
            "description": "Most Recent MME queries the following elements:",
            "elements": [
              {
                "name": "Morphine Milligram Equivalent (MME)",
                "status": "final or amended",
                "lookback": "most recent in past 6 months"
              }
            ]
          }
        ],
        "tables": [
          {
            "headers": {
              "Name": "Name",
              "Result": { "key": "Result", "formatter": "quantityFormat" },
              "Date": { "key": "Date", "formatter": "datishFormat" }
            },
            "flags": [
              {
                "flag": {
                  "ifGreaterThanOrEqualTo": {
                    "header": "Result",
                    "value": 50
                  }
                },
                "flagText": "CDC Guideline #5: Use lowest effective dose."
              }
            ]
          }
        ]
      },
      {
        "name": "Urine Drug Screens",
        "dataKey": "UrineDrugScreens",
        "dataKeySource": "RiskConsiderations",
        "info": [
          {
            "type": "elements",
            "description": "Urine Drug Screens queries the following elements:",
            "elements": [
              {
                "name": "Urine drug screen",
                "status": "final or amended",
                "lookback": "1 year"
              }
            ]
          }
        ],
        "tables": [
          {
            "headers": {
              "Name": "Name",
              "Result": { "key": "Result", "formatter": "quantityFormat" },
              "Interpretation": "Interpretation",
              "Date": { "key": "Date", "formatter": "datishFormat" }
            },
            "flags": [
              {
                "flag": {
                  "ifAnd": [
                    "ifNone",
                    {
                      "ifOneOrMore": {
                        "table": "OpioidMedications",
                        "source": "HistoricalTreatments"
                      }
                    }
                  ]
                },
                "flagText": "CDC Guideline #10: Use urine drug testing."
              }
            ]
          }
        ]
      },
      {
        "name": "Benzodiazepine Medications",
        "dataKey": "BenzodiazepineMedications",
        "dataKeySource": "RiskConsiderations",
        "info": [
          {
            "type": "elements",
            "description": "Benzodiazepine Medications queries the following elements:",
            "elements": [
              {
                "name": "Benzodiazepine medication statements and orders",
                "status": "any",
                "lookback": "100 years"
              }
            ]
          }
        ],
        "tables": [
          {
            "headers": {
              "Drug Description": "Name",
              "Quantity": { "key": "Quantity", "formatter": "stringSubstitutionFormat", "formatterArguments": [""], "sortable": false},
              "Written Date": { "key": "Start", "formatter": "datishFormat" },
              "Dispensed": { "key": "End", "formatter": "datishFormat" },
              "Prescriber": { "key": "Prescriber", "formatter": "stringSubstitutionFormat", "formatterArguments": [""], "sortable": false},
              "Pharmacy": { "key": "Pharmacy", "formatter": "stringSubstitutionFormat", "formatterArguments": [""], "sortable": false}
            },
            "flags": [
              {
                "flag": {
                  "ifAnd": [
                    "ifOneOrMore",
                    {
                      "ifOneOrMore": {
                        "table": "OpioidMedications",
                        "source": "HistoricalTreatments"
                      }
                    }
                  ]
                },
                "flagText": "CDC Guideline #11: Avoid concurrent opioid and benzodiazepine prescribing."
              },
              {
                "flag": "ifOneOrMore",
                "flagText": "CDC Guideline #11: Avoid concurrent opioid and benzodiazepine prescribing."
              }
            ]
          }
        ]
      },
      {
        "name": "Carisoprodol Medications",
        "dataKey": "CarisoprodolMedications",
        "dataKeySource": "RiskConsiderations",
        "info": [
          {
            "type": "elements",
            "description": "Carisoprodol Medications queries the following elements:",
            "elements": [
              {
                "name": "Carisoprodol medication statements and orders",
                "status": "any",
                "lookback": "100 years"
              }
            ]
          }
        ],
        "tables": [
          {
            "headers": {
              "Drug Description": "Name",
              "Written Date": { "key": "Start", "formatter": "datishFormat" },
              "Dispensed": { "key": "End", "formatter": "datishFormat" },
              "Prescriber": { "key": "Prescriber", "formatter": "stringSubstitutionFormat", "formatterArguments": [""], "sortable": false},
              "Pharmacy": { "key": "Pharmacy", "formatter": "stringSubstitutionFormat", "formatterArguments": [""], "sortable": false}
            },
            "flags": [
              {
                "flag": {
                  "ifAnd": [
                    "ifOneOrMore",
                    {
                      "ifOneOrMore": {
                        "table": "OpioidMedications",
                        "source": "HistoricalTreatments"
                      }
                    }
                  ]
                },
                "flagText": "Carisoprodol medication and at least one opioid medication"
              },
              {
                "flag": "ifOneOrMore",
                "flagText": "Evidence of Carisoprodol medication"
              }
            ]
          }
        ]
      },
      {
        "name": "Naloxone Medications",
        "dataKey": "NaloxoneMedications",
        "dataKeySource": "RiskConsiderations",
        "info": [
          {
            "type": "elements",
            "description": "Naloxone Medications queries the following elements:",
            "elements": [
              {
                "name": "Naloxone medication statements and orders",
                "status": "any",
                "lookback": "n/a"
              }
            ]
          }
        ],
        "tables": [
          {
            "headers": {
              "Drug Description": "Name",
              "Quantity": { "key": "Name", "formatter": "stringSubstitutionFormat", "formatterArguments": [""], "sortable": false},
              "Written Date": { "key": "Start", "formatter": "datishFormat" },
              "Dispensed": { "key": "End", "formatter": "datishFormat" },
              "Prescriber": { "key": "Name", "formatter": "stringSubstitutionFormat", "formatterArguments": [""], "sortable": false},
              "Pharmacy": { "key": "Name", "formatter": "stringSubstitutionFormat", "formatterArguments": [""], "sortable": false}
            },
            "flags": [
              {
                "flag": {
                  "ifAnd": [
                    "ifNone",
                    {
                      "ifGreaterThanOrEqualTo": {
                        "table": "MostRecentMME",
                        "source": "RiskConsiderations",
                        "header": "Result",
                        "value": 50
                      }
                    }
                  ]
                },
                "flagText": "CDC Guideline #8: Use strategies to mitigate risk."
              },
              {
                "flag": "ifOneOrMore",
                "flagText": "CDC Guideline #8: Use strategies to mitigate risk."
              }
            ]
          }
        ]
      }
    ]
  },
  "NonPharmacologicTreatments": {
    "title":"Non-Pharmacologic Treatments",
    "sections": [
      {
        "name": "Non-Pharmacologic Treatments",
        "dataKey": "NonPharmacologicTreatments",
        "dataKeySource": "HistoricalTreatments",
        "omitTitle": true,
        "info": [
          {
            "type": "elements",
            "description": "Non-Pharmacologic Treatments queries the following elements:",
            "elements": [
              {
                "name": "Non-pharmacologic procedures",
                "status": "any",
                "lookback": "2 years"
              }
            ]
          }
        ],
        "tables": [
          {
            "headers": {
              "Name": "Name",
              "Date": { "key": "Date", "formatter": "datishFormat" },
              "Type": "Type"
            },
            "flags": [
              {
                "flag": "ifNone",
                "flagText": "CDC Guideline #1: Opioids are not first-line therapy."
              }
            ]
          }
        ]
      }
    ]
  },
  "PDMPMedications": {
    "title":"State PMP Prescriptions",
    "provenanceText": "State PMP prescriptions are queried from the state prescription monitoring program (PMP).  Dispensers may take up to X days to report prescription fills to the PMP.  An exact match between patient name and DOB is required, or no results will be returned.  It is also possible for prescriptions to be duplicated in the PMP and cross-border fills may not presented.  Historical prescription fills from the PMP go back one year from the data of the query.",
    "dataSource": {
      "endpoint": "{env.REACT_APP_CONF_API_URL}/v/r2/fhir/MedicationOrder",
      "dataKey": "PDMPMedications",
      "dataKeySource": "entry"
    },
    "sections": [
      {
        "name": "PMP Prescriptions",
        "dataKey": "PDMPMedications",
        "dataKeySource": "PDMPMedications",
        "omitTitle": true,
        "info": [
          {
            "type": "elements",
            "description": "The medication order queries the following elements:",
            "elements": [
              {
                "name": "MedicationOrder",
                "status": "any",
                "lookback": "1 year"
              }
            ]
          }
        ],
        "tables": [
          {
            "headers": {
              "Drug Description": {
                "key": "medicationCodeableConcept",
                "formatter": "codeableConceptFormat",
                "formatterArguments": ["medicationCodeableConcept", "text"]
              },
              "Quantity": { "key": "Name", "formatter": "stringSubstitutionFormat", "formatterArguments": [""], "sortable": false},
              "Written Date": { "key": "dateWritten", "formatter": "datishFormat" },
              "Dispensed": { "key": "Name", "formatter": "stringSubstitutionFormat", "formatterArguments": [""], "sortable": false },
              "Prescriber": { "key": "Name", "formatter": "stringSubstitutionFormat", "formatterArguments": [""], "sortable": false},
              "Pharmacy": { "key": "Name", "formatter": "stringSubstitutionFormat", "formatterArguments": [""], "sortable": false}
            }
          }
        ]
      }
    ]
  },
  "Occupation": {
    "title":"Occupational Health",
    "provenanceText": "The data is made available by Carevolution.",
    "lastUpdated": "March 6th 2020, 12:00:00 a.m.",
    "dataSource": {
      "endpoint": "{env.PUBLIC_URL}/ocupacion.json",
      "dataKey": "Occupation",
      "dataKeySource": "entry",
      "processFunction": "processOccupationData"
    },
    "occupationObsCode": "11341-5",
    "itemObsCodeKeys": ["10161-8", "87707-6", "85107-8", "87512-0", "74160-3", "80427-8"],
    "sections": [
      {
        "name": "Current Occupation",
        "dataKey": "Current",
        "dataKeySource": "Occupation",
        "tables": [
          {
            "headers": {
              "Job Title": {
                "key": "jobTitle",
                "sortable": false,
                "formatter": false
              },
              "Description": {
                "key": "description",
                "formatter": "listFormat",
                "sortable" : false
              }
            }
          }
        ]
      },
      {
        "name": "Previous Occupation",
        "dataKey": "Previous",
        "dataKeySource": "Occupation",
        "tables": [
          {
            "headers": {
              "Job Title": {
                "key": "jobTitle",
                "sortable": false,
                "formatter": false
              },
              "Description": {
                "key": "description",
                "formatter": "listFormat",
                "sortable" : false
              }
            }
          }
        ]
      }
    ]
  },
  "PatientEducationMaterials": {
    "title":"Patient Education Materials",
    "sections": [
      {
        "name": "Resources",
        "omitTitle": true,
        "dataKey": "references",
        "dataKeySource": "PatientEducationMaterials",
        "tables": [
          {
            "headers": {
              "Resources": {
                "key": "link",
                "formatter": "linkFormat",
                "formatterArguments": ["title","url"],
                "minWidth": 200,
                "sortable": false
              }
            }
          }
        ]
      }
    ]
  }
}
